<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ver y Modificar Citas</title>
    <link rel="stylesheet" href="estilo.css">
</head>
<body>
    <div class="header-c">
        <button class="logout-button" onclick="volver()">ðŸ¡¸</button>
        <h1>Solicitar Cita</h1>
        <button class="logout-button" onclick="cerrarSesion()">Cerrar SesiÃ³n</button>
    </div>

    <div class="container">
        <h2>Mis Citas</h2>
        <table class="table-ud">
            <thead>
                <tr>
                    <th class="th-ud">Fecha</th>
                    <th class="th-ud">Hora</th>
                    <th class="th-ud">Asunto</th>
                    <th class="th-ud">Acciones</th>
                </tr>
            </thead>
            <tbody id="citas-body">
                <!-- Citas se agregarÃ¡n dinÃ¡micamente aquÃ­ -->
            </tbody>
        </table>
    </div>

    <script>
        const citas = [
            { fecha: "2025-04-10", hora: "10:00", asunto: "RevisiÃ³n de Proyecto" },
            { fecha: "2025-04-15", hora: "14:00", asunto: "AsesorÃ­a AcadÃ©mica" }
        ];

        function cargarCitas() {
            const tbody = document.getElementById("citas-body");
            tbody.innerHTML = "";
            citas.forEach((cita, index) => {
                const row = document.createElement("tr");
                row.innerHTML = `
                    <td class="td-ud">${formatearFechaVista(cita.fecha)}</td>
                    <td class="td-ud">${formatearHoraVista(cita.hora)}</td>
                    <td class="td-ud">${cita.asunto}</td>
                    <td class="td-ud">
                        <button class="btn-modificar" onclick="editarCita(${index})">Modificar</button>
                        <button class="btn-cancelar" onclick="cancelarCita(${index})">Cancelar</button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        function editarCita(index) {
            const tbody = document.getElementById("citas-body");
            const row = tbody.children[index];
            const cita = citas[index];
            row.innerHTML = `
                <td class="td-ud"><input type="date" value="${cita.fecha}"></td>
                <td class="td-ud"><input type="time" value="${cita.hora}"></td>
                <td class="td-ud"><input type="text" value="${cita.asunto}"></td>
                <td class="td-ud">
                    <button class="btn-modificar" onclick="guardarCita(${index})">Guardar</button>
                    <button class="btn-cancelar" onclick="cargarCitas()">Cancelar</button>
                </td>
            `;
        }

        function guardarCita(index) {
            const row = document.getElementById("citas-body").children[index];
            const inputs = row.querySelectorAll("input");
            citas[index] = {
                fecha: inputs[0].value,
                hora: inputs[1].value,
                asunto: inputs[2].value
            };
            cargarCitas();
        }

        function cancelarCita(index) {
            if (confirm("Â¿Seguro que deseas cancelar esta cita?")) {
                citas.splice(index, 1);
                cargarCitas();
            }
        }

        function formatearFechaVista(fechaISO) {
            const [year, month, day] = fechaISO.split("-");
            return `${day}/${month}/${year}`;
        }

        function formatearHoraVista(hora24) {
            const [h, m] = hora24.split(":"), hNum = parseInt(h);
            const ampm = hNum >= 12 ? "PM" : "AM";
            const hora12 = hNum % 12 || 12;
            return `${hora12}:${m} ${ampm}`;
        }

        function volver(){
            window.location.href = "../menu-maes.html";
        }

        function cerrarSesion(){
            window.location.href = "../login.html";
        }

        document.addEventListener("DOMContentLoaded", cargarCitas);

    </script>
</body>
</html>
